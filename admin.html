<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Admin Panel - Premium Store</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="admin-wrapper">
        <!-- Sidebar Navigation -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-store"></i>
                    <h2>Admin Panel</h2>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#settings" class="nav-item" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Store Settings</span>
                </a>
                <a href="#slider" class="nav-item" onclick="showSection('slider')">
                    <i class="fas fa-images"></i>
                    <span>Slider Images</span>
                </a>
                <a href="#products" class="nav-item" onclick="showSection('products')">
                    <i class="fas fa-box"></i>
                    <span>Products</span>
                </a>
                <a href="#brands" class="nav-item" onclick="showSection('brands')">
                    <i class="fas fa-tags"></i>
                    <span>Brands</span>
                </a>
                <a href="#flavors" class="nav-item" onclick="showSection('flavors')">
                    <i class="fas fa-palette"></i>
                    <span>Flavors</span>
                </a>
                <a href="#featured" class="nav-item" onclick="showSection('featured')">
                    <i class="fas fa-star"></i>
                    <span>Featured Products</span>
                </a>
                <a href="#data" class="nav-item" onclick="showSection('data')">
                    <i class="fas fa-database"></i>
                    <span>Data Management</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                        <a href="index.html" class="nav-item">
                            <i class="fas fa-arrow-left"></i>
                            <span>Back to Store</span>
                        </a>
                        <button class="nav-item logout-nav" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </button>
                        <script>
                            // Check authentication
                            if (sessionStorage.getItem('isAdminLoggedIn') !== 'true') {
                                window.location.href = 'login.html';
                            }
                        </script>
            </div>
        </aside>

        <!-- Main Content Area -->
        <div class="admin-content">
            <!-- Top Header Bar -->
            <header class="admin-topbar">
                <div class="topbar-left">
                    <button class="sidebar-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle">Dashboard</h1>
                </div>
                <div class="topbar-right">
                    <a href="index.html" class="topbar-btn">
                        <i class="fas fa-external-link-alt"></i>
                        <span>View Store</span>
                    </a>
            </div>
        </header>

            <main class="admin-main-content">
                <!-- Dashboard Section -->
                <section id="dashboard" class="admin-section active">
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="totalProducts">0</h3>
                                <p>Total Products</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                <i class="fas fa-tags"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="totalBrands">0</h3>
                                <p>Total Brands</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                <i class="fas fa-palette"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="totalFlavors">0</h3>
                                <p>Total Flavors</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                <i class="fas fa-images"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="totalSliders">0</h3>
                                <p>Slider Images</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-welcome">
                        <div class="welcome-card">
                            <h2>Welcome to Admin Panel</h2>
                            <p>Manage your store efficiently with our comprehensive admin dashboard. Use the navigation menu to access different sections.</p>
                            <div class="quick-actions">
                                <button class="quick-action-btn" onclick="showSection('products')">
                                    <i class="fas fa-plus-circle"></i>
                                    Add New Product
                                </button>
                                <button class="quick-action-btn" onclick="showSection('settings')">
                                    <i class="fas fa-cog"></i>
                                    Update Settings
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Store Settings Section -->
                <section id="settings" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-cog"></i> Store Settings</h2>
                        <p>Configure your store's basic information</p>
                    </div>
                    <div class="admin-card">
                        <div class="admin-form">
                            <div class="form-group">
                                <label><i class="fas fa-store"></i> Store Name:</label>
                                <input type="text" id="storeName" class="form-input" placeholder="Enter store name">
                            </div>
                            <button class="save-btn" onclick="saveStoreSettings()">
                                <i class="fas fa-save"></i> Save Store Settings
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Slider Images Section -->
                <section id="slider" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-images"></i> Slider Images Management</h2>
                        <p>Upload and manage your homepage slider images (5 images)</p>
                    </div>
                    <div class="slider-images-admin">
                        <div class="slider-image-item" id="sliderImage1">
                            <div class="slider-image-header">
                                <label><i class="fas fa-image"></i> Slider Image 1:</label>
                            </div>
                            <input type="file" accept="image/*" class="image-upload" onchange="handleSliderImageUpload(1, this)">
                            <div class="image-preview" id="preview1"></div>
                        </div>
                        <div class="slider-image-item" id="sliderImage2">
                            <div class="slider-image-header">
                                <label><i class="fas fa-image"></i> Slider Image 2:</label>
                            </div>
                            <input type="file" accept="image/*" class="image-upload" onchange="handleSliderImageUpload(2, this)">
                            <div class="image-preview" id="preview2"></div>
                        </div>
                        <div class="slider-image-item" id="sliderImage3">
                            <div class="slider-image-header">
                                <label><i class="fas fa-image"></i> Slider Image 3:</label>
                            </div>
                            <input type="file" accept="image/*" class="image-upload" onchange="handleSliderImageUpload(3, this)">
                            <div class="image-preview" id="preview3"></div>
                        </div>
                        <div class="slider-image-item" id="sliderImage4">
                            <div class="slider-image-header">
                                <label><i class="fas fa-image"></i> Slider Image 4:</label>
                            </div>
                            <input type="file" accept="image/*" class="image-upload" onchange="handleSliderImageUpload(4, this)">
                            <div class="image-preview" id="preview4"></div>
                        </div>
                        <div class="slider-image-item" id="sliderImage5">
                            <div class="slider-image-header">
                                <label><i class="fas fa-image"></i> Slider Image 5:</label>
                            </div>
                            <input type="file" accept="image/*" class="image-upload" onchange="handleSliderImageUpload(5, this)">
                            <div class="image-preview" id="preview5"></div>
                        </div>
                    </div>
                </section>

                <!-- Products Management Section -->
                <section id="products" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-box"></i> Products Management</h2>
                        <p>Add, edit, and manage your store products</p>
                    </div>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                        <button class="add-product-btn" onclick="showAddProductForm()">
                            <i class="fas fa-plus"></i> Add New Product
                        </button>
                        <button class="add-product-btn" onclick="exportProducts()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                            <i class="fas fa-download"></i> Export Products
                        </button>
                        <button class="add-product-btn" onclick="importProducts()" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                            <i class="fas fa-file-import"></i> Import Products
                        </button>
                        <input type="file" id="importFileInput" accept=".json,.csv,.xlsx,.xls" style="display: none;" onchange="handleFileImport(event)">
                    </div>
                    
                    <!-- Add/Edit Product Form -->
                    <div class="product-form-container" id="productFormContainer" style="display: none;">
                        <h3 id="formTitle">Add New Product</h3>
                        <form class="product-form" id="productForm">
                            <input type="hidden" id="productId">
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Product Name *</label>
                                    <input type="text" id="productName" class="form-input" required>
                                </div>
                                <div class="form-group">
                                    <label>Price *</label>
                                    <input type="number" id="productPrice" class="form-input" step="0.01" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Brand *</label>
                                    <select id="productBrand" class="form-input" required></select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label><i class="fas fa-palette"></i> Product Flavors with Images *</label>
                                <div id="flavorsContainer" style="margin-top: 10px;">
                                    <!-- Flavors will be added here dynamically -->
                                </div>
                                <button type="button" class="add-btn" onclick="addFlavorField()" style="margin-top: 10px; width: auto;">
                                    <i class="fas fa-plus"></i> Add Flavor
                                </button>
                                <small style="display: block; margin-top: 8px; color: #6b7280;">
                                    Add one or more flavors with images. Each flavor can have its own image.
                                </small>
                            </div>

                            <div class="form-group">
                                <label>Description</label>
                                <textarea id="productDescription" class="form-textarea" rows="4"></textarea>
                            </div>

                            <div class="form-group">
                                <label>Specifications</label>
                                <textarea id="productSpecs" class="form-textarea" rows="3" placeholder="Enter specifications (one per line)"></textarea>
                            </div>

                            <div class="form-group">
                                <label><i class="fas fa-image"></i> Product Image * <small style="color: var(--text-light); font-weight: normal;">(This image will appear on the website)</small></label>
                                <div class="image-upload-wrapper">
                                    <input type="file" id="productImage" accept="image/*" class="image-upload" onchange="previewProductImage(this)" required>
                                    <div class="upload-hint">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>Click to upload product image</p>
                                        <small>Recommended: Square images (500x500px or larger)</small>
                                    </div>
                                </div>
                                <div class="image-preview" id="productImagePreview"></div>
                                <div style="margin-top: 15px; padding: 15px; background: #eff6ff; border-left: 4px solid var(--primary-color); border-radius: 8px;">
                                    <p style="margin: 0; color: var(--text-color); font-size: 14px; font-weight: 600;">
                                        <i class="fas fa-lightbulb"></i> Important:
                                    </p>
                                    <ul style="margin: 8px 0 0 20px; color: var(--text-color); font-size: 13px; line-height: 1.8;">
                                        <li>Upload an image that matches your product name (e.g., for "TYSON 2.0 7500PUFF", upload a TYSON vape image)</li>
                                        <li>This image will appear on the homepage, product listings, and product detail pages</li>
                                        <li>Recommended size: 500x500px or larger (square images work best)</li>
                                        <li>Supported formats: JPG, PNG, GIF, WebP</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Additional Images (Optional)</label>
                                <input type="file" id="additionalImages" accept="image/*" multiple class="image-upload" onchange="previewAdditionalImages(this)">
                                <div class="additional-images-preview" id="additionalImagesPreview"></div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Stock Quantity</label>
                                    <input type="number" id="productStock" class="form-input" value="0">
                                </div>
                                <div class="form-group">
                                    <label>Status</label>
                                    <select id="productStatus" class="form-input">
                                        <option value="available">Available</option>
                                        <option value="out-of-stock">Out of Stock</option>
                                        <option value="coming-soon">Coming Soon</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="save-btn">Save Product</button>
                                <button type="button" class="cancel-btn" onclick="hideProductForm()">Cancel</button>
                            </div>
                        </form>
                    </div>

                    <!-- Products List -->
                    <div class="products-admin-list" id="productsAdminList"></div>
                </section>

                <!-- Brands Management Section -->
                <section id="brands" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-tags"></i> Brands Management</h2>
                        <p>Manage product brands and their sub-brands</p>
                    </div>
                    <div class="admin-card">
                        <div class="admin-form">
                            <div class="form-group">
                                <label><i class="fas fa-tag"></i> Brand Name:</label>
                                <div class="input-with-btn">
                                    <input type="text" id="newBrand" class="form-input" placeholder="Enter brand name">
                                    <button class="add-btn" onclick="addBrand()">
                                        <i class="fas fa-plus"></i> Add Brand
                                    </button>
                                </div>
                            </div>
                            <div class="brands-list" id="brandsList"></div>
                        </div>
                    </div>
                </section>

                <!-- Flavors Management Section -->
                <section id="flavors" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-palette"></i> Flavors Management</h2>
                        <p>View, add, edit, and delete product flavors. All flavors from existing products are automatically synced here.</p>
                    </div>
                    <div class="admin-card">
                        <div class="admin-form">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 15px; background: #f0f9ff; border-radius: 12px; border: 2px solid #bae6fd;">
                                <div>
                                    <strong style="color: #0369a1;">ðŸ“‹ Note:</strong>
                                    <p style="margin: 5px 0 0 0; color: #075985; font-size: 14px;">
                                        All flavors used in your products are automatically displayed here. You can edit or delete flavors, but deleting a flavor will remove it from all products that use it.
                                    </p>
                                </div>
                                <button class="btn-primary" onclick="syncFlavorsFromProducts(); loadFlavors(); alert('Flavors synced successfully!');" style="white-space: nowrap;">
                                    <i class="fas fa-sync-alt"></i> Sync Flavors
                                </button>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-palette"></i> Add New Flavor:</label>
                                <div class="input-with-btn">
                                    <input type="text" id="newFlavor" class="form-input" placeholder="Enter flavor name (e.g., Blue Razz Ice, Mint, etc.)">
                                    <button class="add-btn" onclick="addFlavor()">
                                        <i class="fas fa-plus"></i> Add Flavor
                                    </button>
                                </div>
                            </div>
                            <div style="margin-top: 30px;">
                                <h3 style="margin-bottom: 15px; color: #374151; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-list"></i> All Flavors (<span id="flavorsCount">0</span>)
                                </h3>
                                <div class="flavors-list" id="flavorsList"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Featured Products Section -->
                <section id="featured" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-star"></i> Featured Products Management</h2>
                        <p>Select up to 4 products to feature on the homepage</p>
                    </div>
                    <div class="admin-card">
                        <div class="featured-products-admin">
                            <p style="margin-bottom: 20px; color: var(--text-light);">
                                <i class="fas fa-info-circle"></i> Select 4 products to display in the "Featured Products" section on your homepage.
                            </p>
                            <div class="featured-products-grid" id="featuredProductsGrid">
                                <!-- Featured product slots will be populated here -->
                            </div>
                            <div style="margin-top: 30px;">
                                <button class="save-btn" onclick="saveFeaturedProducts()">
                                    <i class="fas fa-save"></i> Save Featured Products
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Data Management Section -->
                <section id="data" class="admin-section">
                    <div class="section-header">
                        <h2><i class="fas fa-database"></i> Data Export & Import</h2>
                        <p>Export your store data to use on another computer, or import data from another computer</p>
                    </div>
                    <div class="admin-card">
                        <div class="data-actions">
                            <button class="data-action-btn export-btn" onclick="exportData()">
                                <i class="fas fa-download"></i>
                                <span>Export All Data</span>
                                <small>Download JSON file</small>
                            </button>
                            <label for="importFile" class="data-action-btn import-btn">
                                <i class="fas fa-upload"></i>
                                <span>Import Data</span>
                                <small>Upload JSON file</small>
                                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(this)">
                            </label>
                            <button class="data-action-btn backup-btn" onclick="createBackup()">
                                <i class="fas fa-save"></i>
                                <span>Create Backup</span>
                                <small>Save all data</small>
                            </button>
                            <button class="data-action-btn" onclick="clearAllData()" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                <i class="fas fa-trash-alt"></i>
                                <span>Clear All Data</span>
                                <small>Delete products, brands, flavors</small>
                            </button>
                        </div>
                        <div class="data-info">
                            <h3><i class="fas fa-info-circle"></i> How to Export & Transfer to Another Computer:</h3>
                            <ol>
                                <li><strong>Export Data:</strong> Click "Export All Data" - this will download:
                                    <ul>
                                        <li>A JSON file with all your store data</li>
                                        <li>All product images as separate files (product-*.jpg)</li>
                                        <li>All slider images as separate files (slider-*.jpg)</li>
                                    </ul>
                                </li>
                                <li><strong>Create Images Folder:</strong> Create a folder named "images" in your website directory</li>
                                <li><strong>Copy Images:</strong> Move all downloaded image files (product-*.jpg, slider-*.jpg) into the "images" folder</li>
                                <li><strong>Transfer to New Computer:</strong> Copy the entire website folder including:
                                    <ul>
                                        <li>All HTML, CSS, JS files</li>
                                        <li>The "images" folder with all image files</li>
                                        <li>The exported JSON file (optional - for backup)</li>
                                    </ul>
                                </li>
                                <li><strong>Import on New Computer:</strong> Open admin panel and click "Import Data", then select the JSON file</li>
                                <li><strong>Verify:</strong> Make sure the "images" folder is in the same directory as your HTML files</li>
                            </ol>
                            <p style="margin-top: 15px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
                                <strong>Important:</strong> Images are stored as files in the "images" folder, not in localStorage. This allows you to easily transfer your website to another computer by copying the entire folder.
                            </p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>

